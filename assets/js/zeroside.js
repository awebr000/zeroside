function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=n.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}function updateProgress(e){if(e.lengthComputable){var t=(e.loaded/e.total*100).toFixed(0);document.getElementById("title").innerHTML="Upload -> "+t+"%",document.getElementById("progress").value=t,t>=100&&(document.getElementById("title").innerHTML="ZeroSide: Anonymous File Sharing")}else console.log("Error progress bar")}var _submit=document.getElementById("submit"),_file=document.getElementById("actual-upload"),notify=function(e,t){var n='<div class="notification '+t+'">',a="</div>",o=n+e+a;document.getElementById("notibox").innerHTML=o},check=function(e){var t=new XMLHttpRequest,n="/api/check",a="id="+e;t.open("POST",n,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var e=document.getElementById("message"),n=JSON.parse(t.responseText);200==n.code?e.innerText="This URL is available":e.innerText="This URL is already taken"}},t.send(a)},upload=function(){if(0!==_file.files.length){var e=new FormData;e.append("SelectedFile",_file.files[0]);var t=document.getElementById("downurl").value,n=document.getElementById("expiration");e.append("downurl",t),e.append("expiration",n.options[n.selectedIndex].value);var a=new XMLHttpRequest;a.upload.onprogress=updateProgress,a.onreadystatechange=function(){if(4==a.readyState&&4==a.readyState&&200==a.status){var e=JSON.parse(a.responseText);console.log(e),"error"==e.status?notify("Upload failed, please retry","is-danger"):(notify(e.data,"is-success"),document.getElementById("staturl").value="https://www.zeroside.co/s/"+e.stat)}},a.open("POST","/api/upload"),a.send(e)}};document.addEventListener("DOMContentLoaded",function(){document.getElementById("upload").addEventListener("click",function(){document.getElementById("actual-upload").click()}),_submit.addEventListener("click",upload),404==getParameterByName("r")?notify("This page does not exists or expired.","is-danger"):"404d"==getParameterByName("r")?notify("This download is invalid. <br>Please retry later","is-warning"):500==getParameterByName("r")&&notify("Server error<br>Please retry later or contact administrator (via GitHub issues)","is-danger")});
